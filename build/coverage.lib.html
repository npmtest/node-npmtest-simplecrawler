<!doctype html>
<html lang="en">
<head>
    <title>Code coverage report for node-npmtest-simplecrawler/node_modules/simplecrawler/lib/queue.js</title>
    <meta charset="utf-8">
    <style>
        body, html {
            margin:0; padding: 0;
        }
        body {
            font-family: Arial, Helvetica;
            font-size: 10pt;
        }
        div.header, div.footer {
            background: #eee;
            padding: 1em;
        }
        div.header {
            height: 160px;
            padding: 0 1em 0 1em;
            z-index: 100;
            position: fixed;
            top: 0;
            border-bottom: 1px solid #666;
            width: 100%;
        }
        div.footer {
            border-top: 1px solid #666;
        }
        div.body {
            margin-top: 170px;
        }
        div.meta {
            font-size: 90%;
            text-align: center;
        }
        h1, h2, h3 {
            font-weight: normal;
        }
        h1 {
            font-size: 12pt;
        }
        h2 {
            font-size: 10pt;
        }
        pre {
            font-family: Menlo, Monaco, Consolas, Courier New, monospace;
            margin: 0;
            padding: 0;
            font-size: 14px;
            tab-size: 2;
        }

        div.path { font-size: 110%; }
        div.path a:link, div.path a:visited { color: #000; }
        table.coverage { border-collapse: collapse; margin:0; padding: 0 }

        table.coverage td {
            margin: 0;
            padding: 0;
            color: #111;
            vertical-align: top;
        }
        table.coverage td.line-count {
            width: 50px;
            text-align: right;
            padding-right: 5px;
        }
        table.coverage td.line-coverage {
            color: #777 !important;
            text-align: right;
            border-left: 1px solid #666;
            border-right: 1px solid #666;
        }

        table.coverage td.text {
        }

        table.coverage td span.cline-any {
            display: inline-block;
            padding: 0 5px;
            width: 40px;
        }
        table.coverage td span.cline-neutral {
            background: #eee;
        }
        table.coverage td span.cline-yes {
            background: #b5d592;
            color: #999;
        }
        table.coverage td span.cline-no {
            background: #fc8c84;
        }

        .cstat-yes { color: #111; }
        .cstat-no { background: #fc8c84; color: #111; }
        .fstat-no { background: #ffc520; color: #111 !important; }
        .cbranch-no { background:  yellow !important; color: #111; }

        .cstat-skip { background: #ddd; color: #111; }
        .fstat-skip { background: #ddd; color: #111 !important; }
        .cbranch-skip { background: #ddd !important; color: #111; }

        .missing-if-branch {
            display: inline-block;
            margin-right: 10px;
            position: relative;
            padding: 0 4px;
            background: black;
            color: yellow;
        }

        .skip-if-branch {
            display: none;
            margin-right: 10px;
            position: relative;
            padding: 0 4px;
            background: #ccc;
            color: white;
        }

        .missing-if-branch .typ, .skip-if-branch .typ {
            color: inherit !important;
        }

        .entity, .metric { font-weight: bold; }
        .metric { display: inline-block; border: 1px solid #333; padding: 0.3em; background: white; }
        .metric small { font-size: 80%; font-weight: normal; color: #666; }

        div.coverage-summary table { border-collapse: collapse; margin: 3em; font-size: 110%; }
        div.coverage-summary td, div.coverage-summary table  th { margin: 0; padding: 0.25em 1em; border-top: 1px solid #666; border-bottom: 1px solid #666; }
        div.coverage-summary th { text-align: left; border: 1px solid #666; background: #eee; font-weight: normal; }
        div.coverage-summary th.file { border-right: none !important; }
        div.coverage-summary th.pic { border-left: none !important; text-align: right; }
        div.coverage-summary th.pct { border-right: none !important; }
        div.coverage-summary th.abs { border-left: none !important; text-align: right; }
        div.coverage-summary td.pct { text-align: right; border-left: 1px solid #666; }
        div.coverage-summary td.abs { text-align: right; font-size: 90%; color: #444; border-right: 1px solid #666; }
        div.coverage-summary td.file { text-align: right; border-left: 1px solid #666; white-space: nowrap;  }
        div.coverage-summary td.pic { min-width: 120px !important;  }
        div.coverage-summary a:link { color: #000; }
        div.coverage-summary a:visited { color: #333; }
        div.coverage-summary tfoot td { border-top: 1px solid #666; }

        div.coverage-summary .yui3-datatable-sort-indicator, div.coverage-summary .dummy-sort-indicator {
            height: 10px;
            width: 7px;
            display: inline-block;
            margin-left: 0.5em;
        }
        div.coverage-summary .yui3-datatable-sort-indicator {
            background: no-repeat scroll 0 0 transparent;
        }
        div.coverage-summary .yui3-datatable-sorted .yui3-datatable-sort-indicator {
            background-position: 0 -20px;
        }
        div.coverage-summary .yui3-datatable-sorted-desc .yui3-datatable-sort-indicator {
            background-position: 0 -10px;
        }

        .high { background: #b5d592 !important; }
        .medium { background: #ffe87c !important; }
        .low { background: #fc8c84 !important; }

        span.cover-fill, span.cover-empty {
            display:inline-block;
            border:1px solid #444;
            background: white;
            height: 12px;
        }
        span.cover-fill {
            background: #ccc;
            border-right: 1px solid #444;
        }
        span.cover-empty {
            background: white;
            border-left: none;
        }
        span.cover-full {
            border-right: none !important;
        }
        pre.prettyprint {
            border: none !important;
            padding: 0 !important;
            margin: 0 !important;
        }
        .com { color: #999 !important; }
        .ignore-none { color: #999; font-weight: normal; }

    </style>
</head>
<body>
<div class="header low">
    <h1 style="font-weight: bold;">
        <a href="https://github.com/npmtest/node-npmtest-simplecrawler">npmtest-simplecrawler (v0.0.1)</a>
    </h1>
    <h1>Code coverage report for <span class="entity">node-npmtest-simplecrawler/node_modules/simplecrawler/lib/queue.js</span></h1>
    <h2>
        
        Statements: <span class="metric">14.49% <small>(20 / 138)</small></span> &nbsp;&nbsp;&nbsp;&nbsp;
        
        
        Branches: <span class="metric">0% <small>(0 / 66)</small></span> &nbsp;&nbsp;&nbsp;&nbsp;
        
        
        Functions: <span class="metric">0% <small>(0 / 27)</small></span> &nbsp;&nbsp;&nbsp;&nbsp;
        
        
        Lines: <span class="metric">14.49% <small>(20 / 138)</small></span> &nbsp;&nbsp;&nbsp;&nbsp;
        
        Ignored: <span class="metric"><span class="ignore-none">none</span></span> &nbsp;&nbsp;&nbsp;&nbsp;
    </h2>
    <div class="path"><a href="../../../../index.html">All files</a> &#187; <a href="index.html">node-npmtest-simplecrawler/node_modules/simplecrawler/lib/</a> &#187; queue.js</div>
</div>
<div class="body">
<pre><table class="coverage">
<tr><td class="line-count">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
40
41
42
43
44
45
46
47
48
49
50
51
52
53
54
55
56
57
58
59
60
61
62
63
64
65
66
67
68
69
70
71
72
73
74
75
76
77
78
79
80
81
82
83
84
85
86
87
88
89
90
91
92
93
94
95
96
97
98
99
100
101
102
103
104
105
106
107
108
109
110
111
112
113
114
115
116
117
118
119
120
121
122
123
124
125
126
127
128
129
130
131
132
133
134
135
136
137
138
139
140
141
142
143
144
145
146
147
148
149
150
151
152
153
154
155
156
157
158
159
160
161
162
163
164
165
166
167
168
169
170
171
172
173
174
175
176
177
178
179
180
181
182
183
184
185
186
187
188
189
190
191
192
193
194
195
196
197
198
199
200
201
202
203
204
205
206
207
208
209
210
211
212
213
214
215
216
217
218
219
220
221
222
223
224
225
226
227
228
229
230
231
232
233
234
235
236
237
238
239
240
241
242
243
244
245
246
247
248
249
250
251
252
253
254
255
256
257
258
259
260
261
262
263
264
265
266
267
268
269
270
271
272
273
274
275
276
277
278
279
280
281
282
283
284
285
286
287
288
289
290
291
292
293
294
295
296
297
298
299
300
301
302
303
304
305
306
307
308
309
310
311
312
313
314
315
316
317
318
319
320
321
322
323
324
325
326
327
328
329
330
331
332
333
334
335
336
337
338
339
340
341
342
343
344
345
346
347
348
349
350
351
352
353
354
355
356
357
358
359
360
361
362
363
364
365
366
367
368
369
370
371
372
373
374
375
376
377
378
379
380
381
382
383
384
385
386
387
388
389
390
391
392
393
394
395
396
397
398
399
400
401
402
403
404
405
406
407
408
409
410
411
412
413
414
415
416
417
418
419
420
421
422
423
424
425
426
427
428
429
430
431
432
433
434
435
436
437
438
439
440
441
442
443
444
445
446
447
448
449
450
451
452
453
454
455
456
457
458
459
460
461
462
463
464
465
466
467
468
469
470
471
472
473
474
475
476
477
478
479
480
481
482
483
484
485
486
487
488
489
490</td><td class="line-coverage"><span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">1</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">1</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">1</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">1</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">1</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">1</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">1</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">1</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">1</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">1</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">1</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">1</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">1</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">1</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">1</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">1</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">1</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">1</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">1</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">1</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span></td><td class="text"><pre class="prettyprint lang-js">/**
 * @file simplecrawler's queue implementation. This also serves as a reference
 * for the queue interface, that can be implemented by third parties as well
 */
&nbsp;
var fs   = require("fs"),
    util = require("util");
&nbsp;
/**
 * Recursive function that compares immutable properties on two objects.
 * @private
 * @param {Object} a Source object that will be compared against
 * @param {Object} b Comparison object. The functions determines if all of this object's properties are the same on the first object.
 * @return {Boolean} Returns true if all of the properties on `b` matched a property on `a`. If not, it returns false.
 */
<span class="fstat-no" title="function not covered" >function compare(a, b) {</span>
<span class="cstat-no" title="statement not covered" >    for (var key in a) {</span>
<span class="cstat-no" title="statement not covered" >        if (a.hasOwnProperty(key)) {</span>
&nbsp;
<span class="cstat-no" title="statement not covered" >            if (typeof a[key] !== typeof b[key]) {</span>
<span class="cstat-no" title="statement not covered" >                return false;</span>
            }
&nbsp;
<span class="cstat-no" title="statement not covered" >            if (typeof a[key] === "object") {</span>
<span class="cstat-no" title="statement not covered" >                if (!compare(a[key], b[key])) {</span>
<span class="cstat-no" title="statement not covered" >                    return false;</span>
                }
            } else <span class="cstat-no" title="statement not covered" >if (a[key] !== b[key]) {</span>
<span class="cstat-no" title="statement not covered" >                return false;</span>
            }
        }
    }
&nbsp;
<span class="cstat-no" title="statement not covered" >    return true;</span>
}
&nbsp;
/**
 * Recursive function that takes two objects and updates the properties on the
 * first object based on the ones in the second. Basically, it's a recursive
 * version of Object.assign.
 */
<span class="fstat-no" title="function not covered" >function deepAssign(object, source) {</span>
<span class="cstat-no" title="statement not covered" >    for (var key in source) {</span>
<span class="cstat-no" title="statement not covered" >        if (source.hasOwnProperty(key)) {</span>
<span class="cstat-no" title="statement not covered" >            if (typeof object[key] === "object" &amp;&amp; typeof source[key] === "object") {</span>
<span class="cstat-no" title="statement not covered" >                deepAssign(object[key], source[key]);</span>
            } else {
<span class="cstat-no" title="statement not covered" >                object[key] = source[key];</span>
            }
        }
    }
&nbsp;
<span class="cstat-no" title="statement not covered" >    return object;</span>
}
&nbsp;
/**
 * Creates a new queue
 * @class
 */
var FetchQueue = <span class="fstat-no" title="function not covered" >function() {</span>
<span class="cstat-no" title="statement not covered" >    Array.call(this);</span>
&nbsp;
    /**
     * Speeds up {@link FetchQueue.oldestUnfetchedItem} by storing the index at
     * which the latest oldest unfetched queue item was found.
     * @name FetchQueue._oldestUnfetchedIndex
     * @private
     * @type {Number}
     */
<span class="cstat-no" title="statement not covered" >    Object.defineProperty(this, "_oldestUnfetchedIndex", {</span>
        enumerable: false,
        writable: true,
        value: 0
    });
&nbsp;
    /**
     * Serves as a cache for what URL's have been fetched. Keys are URL's,
     * values are booleans.
     * @name FetchQueue._scanIndex
     * @private
     * @type {Object}
     */
<span class="cstat-no" title="statement not covered" >    Object.defineProperty(this, "_scanIndex", {</span>
        enumerable: false,
        writable: true,
        value: {}
    });
&nbsp;
    /**
     * Controls what properties can be operated on with the
     * {@link FetchQueue#min}, {@link FetchQueue#avg} and {@link FetchQueue#max}
     * methods.
     * @name FetchQueue._allowedStatistics
     * @type {Array}
     */
<span class="cstat-no" title="statement not covered" >    Object.defineProperty(this, "_allowedStatistics", {</span>
        enumerable: false,
        writable: true,
        value: [
            "actualDataSize",
            "contentLength",
            "downloadTime",
            "requestLatency",
            "requestTime"
        ]
    });
};
&nbsp;
util.inherits(FetchQueue, Array);
&nbsp;
/**
 * Called when {@link FetchQueue#add} returns a result
 * @callback FetchQueue~addCallback
 * @param {Error} [error]         If the operation was successful, this will be `null`. Otherwise it will be the error that was encountered.
 * @param {QueueItem} [queueItem] The queue item that was added to the queue. It's status property will have changed to `"queued"`.
 */
&nbsp;
/**
 * Adds an item to the queue
 * @param {QueueItem} queueItem             Queue item that is to be added to the queue
 * @param {Boolean} [force=false]           If true, the queue item will be added regardless of whether it already exists in the queue
 * @param {FetchQueue~addCallback} callback
 */
FetchQueue.prototype.add = <span class="fstat-no" title="function not covered" >function(queueItem, force, callback) {</span>
<span class="cstat-no" title="statement not covered" >    var queue = this;</span>
&nbsp;
<span class="fstat-no" title="function not covered" >    function addToQueue() {</span>
<span class="cstat-no" title="statement not covered" >        queue._scanIndex[queueItem.url] = true;</span>
<span class="cstat-no" title="statement not covered" >        queueItem.id = queue.length;</span>
<span class="cstat-no" title="statement not covered" >        queueItem.status = "queued";</span>
<span class="cstat-no" title="statement not covered" >        queue.push(queueItem);</span>
<span class="cstat-no" title="statement not covered" >        callback(null, queueItem);</span>
    }
&nbsp;
<span class="cstat-no" title="statement not covered" >    queue.exists(queueItem.url, <span class="fstat-no" title="function not covered" >function(err, exists) {</span></span>
<span class="cstat-no" title="statement not covered" >        if (err) {</span>
<span class="cstat-no" title="statement not covered" >            callback(err);</span>
        } else <span class="cstat-no" title="statement not covered" >if (!exists) {</span>
<span class="cstat-no" title="statement not covered" >            addToQueue();</span>
        } else <span class="cstat-no" title="statement not covered" >if (force) {</span>
<span class="cstat-no" title="statement not covered" >            if (queue.indexOf(queueItem) &gt; -1) {</span>
<span class="cstat-no" title="statement not covered" >                callback(new Error("Can't add a queueItem instance twice. You may create a new one from the same URL however."));</span>
            } else {
<span class="cstat-no" title="statement not covered" >                addToQueue();</span>
            }
        } else {
<span class="cstat-no" title="statement not covered" >            var error = new Error("Resource already exists in queue!");</span>
<span class="cstat-no" title="statement not covered" >            error.code = "DUPLICATE";</span>
<span class="cstat-no" title="statement not covered" >            callback(error);</span>
        }
    });
};
&nbsp;
/**
 * Called when {@link FetchQueue#exists} returns a result
 * @callback FetchQueue~existsCallback
 * @param {Error} [error]  If the operation was successful, this will be `null`. Otherwise it will be the error that was encountered.
 * @param {Number} [count] The number of occurences in the queue of the provided URL.
 */
&nbsp;
/**
 * Checks if a URL already exists in the queue. Returns the number of occurences
 * of that URL.
 * @param {String} url                         URL to check the existence of in the queue
 * @param {FetchQueue~existsCallback} callback
 */
FetchQueue.prototype.exists = <span class="fstat-no" title="function not covered" >function(url, callback) {</span>
<span class="cstat-no" title="statement not covered" >    if (this._scanIndex[url]) {</span>
<span class="cstat-no" title="statement not covered" >        callback(null, 1);</span>
    } else {
<span class="cstat-no" title="statement not covered" >        callback(null, 0);</span>
    }
};
&nbsp;
/**
 * Called when {@link FetchQueue#get} returns a result
 * @callback FetchQueue~getCallback
 * @param {Error} [error]         If the operation was successful, this will be `null`. Otherwise it will be the error that was encountered.
 * @param {QueueItem} [queueItem] The queue item found at that index in the queue.
 */
&nbsp;
/**
 * Get a queue item by index
 * @param {Number} index                    The index of the queue item in the queue
 * @param {FetchQueue~getCallback} callback
 */
FetchQueue.prototype.get = <span class="fstat-no" title="function not covered" >function(index, callback) {</span>
<span class="cstat-no" title="statement not covered" >    var queue = this;</span>
&nbsp;
<span class="cstat-no" title="statement not covered" >    queue.getLength(<span class="fstat-no" title="function not covered" >function(error, length) {</span></span>
<span class="cstat-no" title="statement not covered" >        if (error) {</span>
<span class="cstat-no" title="statement not covered" >            callback(error);</span>
        } else <span class="cstat-no" title="statement not covered" >if (index &gt;= length) {</span>
<span class="cstat-no" title="statement not covered" >            callback(new RangeError("Index was greater than the queue's length"));</span>
        } else {
<span class="cstat-no" title="statement not covered" >            callback(null, queue[index]);</span>
        }
    });
};
&nbsp;
/**
 * Called when {@link FetchQueue#update} returns a result
 * @callback FetchQueue~updateCallback
 * @param {Error} [error]         If the operation was successful, this will be `null`. Otherwise it will be the error that was encountered.
 * @param {QueueItem} [queueItem] The updated queue item
 */
&nbsp;
/**
 * Updates a queue item in the queue.
 * @param {Number} id                          ID of the queue item that is to be updated
 * @param {Object} updates                     Object that will be deeply assigned (as in `Object.assign`) to the queue item. That means that nested objects will also be resursively assigned.
 * @param {FetchQueue~updateCallback} callback
 */
FetchQueue.prototype.update = <span class="fstat-no" title="function not covered" >function (id, updates, callback) {</span>
<span class="cstat-no" title="statement not covered" >    var queue = this,</span>
        queueItem;
&nbsp;
<span class="cstat-no" title="statement not covered" >    for (var i = 0; i &lt; queue.length; i++) {</span>
<span class="cstat-no" title="statement not covered" >        if (queue[i].id === id) {</span>
<span class="cstat-no" title="statement not covered" >            queueItem = queue[i];</span>
<span class="cstat-no" title="statement not covered" >            break;</span>
        }
    }
&nbsp;
<span class="cstat-no" title="statement not covered" >    if (!queueItem) {</span>
<span class="cstat-no" title="statement not covered" >        callback(new Error("No queueItem found with that URL"));</span>
    } else {
<span class="cstat-no" title="statement not covered" >        deepAssign(queueItem, updates);</span>
<span class="cstat-no" title="statement not covered" >        callback(null, queueItem);</span>
    }
};
&nbsp;
/**
 * Called when {@link FetchQueue#oldestUnfetchedItem} returns a result
 * @callback FetchQueue~oldestUnfetchedItemCallback
 * @param {Error} [error]         If the operation was successful, this will be `null`. Otherwise it will be the error that was encountered.
 * @param {QueueItem} [queueItem] If there are unfetched queue items left, this will be the oldest one found. If not, this will be `null`.
 */
&nbsp;
/**
 * Gets the first unfetched item in the queue
 * @param {FetchQueue~oldestUnfetchedItemCallback} callback
 */
FetchQueue.prototype.oldestUnfetchedItem = <span class="fstat-no" title="function not covered" >function(callback) {</span>
<span class="cstat-no" title="statement not covered" >    var queue = this;</span>
&nbsp;
<span class="cstat-no" title="statement not covered" >    for (var i = queue._oldestUnfetchedIndex; i &lt; queue.length; i++) {</span>
<span class="cstat-no" title="statement not covered" >        if (queue[i].status === "queued") {</span>
<span class="cstat-no" title="statement not covered" >            queue._oldestUnfetchedIndex = i;</span>
<span class="cstat-no" title="statement not covered" >            callback(null, queue[i]);</span>
<span class="cstat-no" title="statement not covered" >            return;</span>
        }
    }
&nbsp;
    // When no unfetched queue items remain, we previously called back with an
    // error, but since it's not really an error condition, we opted to just
    // call back with (null, null) instead
<span class="cstat-no" title="statement not covered" >    callback(null, null);</span>
};
&nbsp;
/**
 * Called when {@link FetchQueue#max} returns a result
 * @callback FetchQueue~maxCallback
 * @param {Error} [error] If the operation was successful, this will be `null`. Otherwise it will be the error that was encountered.
 * @param {Number} [max]  The maximum value of the property that was initially provided
 */
&nbsp;
/**
 * Gets the maximum value of a stateData property from all the items in the
 * queue. This means you can eg. get the maximum request time, download size
 * etc.
 * @param {String} statisticName            Can be any of the strings in {@link FetchQueue._allowedStatistics}
 * @param {FetchQueue~maxCallback} callback
 */
FetchQueue.prototype.max = <span class="fstat-no" title="function not covered" >function(statisticName, callback) {</span>
<span class="cstat-no" title="statement not covered" >    var maximum = 0,</span>
        queue = this;
&nbsp;
<span class="cstat-no" title="statement not covered" >    if (queue._allowedStatistics.indexOf(statisticName) === -1) {</span>
<span class="cstat-no" title="statement not covered" >        return callback(new Error("Invalid statistic"));</span>
    }
&nbsp;
<span class="cstat-no" title="statement not covered" >    queue.forEach(<span class="fstat-no" title="function not covered" >function(item) {</span></span>
<span class="cstat-no" title="statement not covered" >        if (item.fetched &amp;&amp; item.stateData[statisticName] &gt; maximum) {</span>
<span class="cstat-no" title="statement not covered" >            maximum = item.stateData[statisticName];</span>
        }
    });
&nbsp;
<span class="cstat-no" title="statement not covered" >    callback(null, maximum);</span>
};
&nbsp;
/**
 * Called when {@link FetchQueue#min} returns a result
 * @callback FetchQueue~minCallback
 * @param {Error} [error] If the operation was successful, this will be `null`. Otherwise it will be the error that was encountered.
 * @param {Number} [min]  The minimum value of the property that was initially provided
 */
&nbsp;
/**
 * Gets the minimum value of a stateData property from all the items in the
 * queue. This means you can eg. get the minimum request time, download size
 * etc.
 * @param {String} statisticName            Can be any of the strings in {@link FetchQueue._allowedStatistics}
 * @param {FetchQueue~minCallback} callback
 */
FetchQueue.prototype.min = <span class="fstat-no" title="function not covered" >function(statisticName, callback) {</span>
<span class="cstat-no" title="statement not covered" >    var minimum = Infinity,</span>
        queue = this;
&nbsp;
<span class="cstat-no" title="statement not covered" >    if (queue._allowedStatistics.indexOf(statisticName) === -1) {</span>
<span class="cstat-no" title="statement not covered" >        return callback(new Error("Invalid statistic"));</span>
    }
&nbsp;
<span class="cstat-no" title="statement not covered" >    queue.forEach(<span class="fstat-no" title="function not covered" >function(item) {</span></span>
<span class="cstat-no" title="statement not covered" >        if (item.fetched &amp;&amp; item.stateData[statisticName] &lt; minimum) {</span>
<span class="cstat-no" title="statement not covered" >            minimum = item.stateData[statisticName];</span>
        }
    });
&nbsp;
<span class="cstat-no" title="statement not covered" >    callback(null, minimum === Infinity ? 0 : minimum);</span>
};
&nbsp;
/**
 * Called when {@link FetchQueue#avg} returns a result
 * @callback FetchQueue~avgCallback
 * @param {Error} [error] If the operation was successful, this will be `null`. Otherwise it will be the error that was encountered.
 * @param {Number} [avg]  The average value of the property that was initially provided
 */
&nbsp;
/**
 * Gets the average value of a stateData property from all the items in the
 * queue. This means you can eg. get the average request time, download size
 * etc.
 * @param {String} statisticName            Can be any of the strings in {@link FetchQueue._allowedStatistics}
 * @param {FetchQueue~avgCallback} callback
 */
FetchQueue.prototype.avg = <span class="fstat-no" title="function not covered" >function(statisticName, callback) {</span>
<span class="cstat-no" title="statement not covered" >    var sum = 0,</span>
        count = 0,
        queue = this;
&nbsp;
<span class="cstat-no" title="statement not covered" >    if (queue._allowedStatistics.indexOf(statisticName) === -1) {</span>
<span class="cstat-no" title="statement not covered" >        return callback(new Error("Invalid statistic"));</span>
    }
&nbsp;
<span class="cstat-no" title="statement not covered" >    queue.forEach(<span class="fstat-no" title="function not covered" >function(item) {</span></span>
<span class="cstat-no" title="statement not covered" >        if (item.fetched &amp;&amp; Number.isFinite(item.stateData[statisticName])) {</span>
<span class="cstat-no" title="statement not covered" >            sum += item.stateData[statisticName];</span>
<span class="cstat-no" title="statement not covered" >            count++;</span>
        }
    });
&nbsp;
<span class="cstat-no" title="statement not covered" >    callback(null, sum / count);</span>
};
&nbsp;
/**
 * Called when {@link FetchQueue#countItems} returns a result
 * @callback FetchQueue~countItemsCallback
 * @param {Error} [error]  If the operation was successful, this will be `null`. Otherwise it will be the error that was encountered.
 * @param {Number} [count] The number of items that matched the provided selector
 */
&nbsp;
/**
 * Counts the items in the queue that match a selector
 * @param {Object} comparator                      Comparator object used to filter items. Queue items that are counted need to match all the properties of this object.
 * @param {FetchQueue~countItemsCallback} callback
 */
FetchQueue.prototype.countItems = <span class="fstat-no" title="function not covered" >function(comparator, callback) {</span>
<span class="cstat-no" title="statement not covered" >    this.filterItems(comparator, <span class="fstat-no" title="function not covered" >function(error, items) {</span></span>
<span class="cstat-no" title="statement not covered" >        if (error) {</span>
<span class="cstat-no" title="statement not covered" >            callback(error);</span>
        } else {
<span class="cstat-no" title="statement not covered" >            callback(null, items.length);</span>
        }
    });
};
&nbsp;
/**
 * Called when {@link FetchQueue#filterItems} returns a result
 * @callback FetchQueue~filterItemsCallback
 * @param {Error} [error]       If the operation was successful, this will be `null`. Otherwise it will be the error that was encountered.
 * @param {QueueItem[]} [items] The items that matched the provided selector
 */
&nbsp;
/**
 * Filters and returns the items in the queue that match a selector
 * @param {Object} comparator                       Comparator object used to filter items. Queue items that are returned need to match all the properties of this object.
 * @param {FetchQueue~filterItemsCallback} callback
 */
FetchQueue.prototype.filterItems = <span class="fstat-no" title="function not covered" >function(comparator, callback) {</span>
<span class="cstat-no" title="statement not covered" >    var items = this.filter(<span class="fstat-no" title="function not covered" >function(queueItem) {</span></span>
<span class="cstat-no" title="statement not covered" >        return compare(comparator, queueItem);</span>
    });
&nbsp;
<span class="cstat-no" title="statement not covered" >    callback(null, items);</span>
};
&nbsp;
/**
 * Called when {@link FetchQueue#getLength} returns a result
 * @callback FetchQueue~getLengthCallback
 * @param {Error} [error]  If the operation was successful, this will be `null`. Otherwise it will be the error that was encountered.
 * @param {Number} [items] The total number of items in the queue
 */
&nbsp;
/**
 * Gets the total number of queue items in the queue
 * @param {FetchQueue~getLengthCallback} callback
 */
FetchQueue.prototype.getLength = <span class="fstat-no" title="function not covered" >function(callback) {</span>
<span class="cstat-no" title="statement not covered" >    callback(null, this.length);</span>
};
&nbsp;
/**
 * Called when {@link FetchQueue#freeze} returns a result
 * @callback FetchQueue~freezeCallback
 * @param {Error} [error] If the operation was successful, this will be `null`. Otherwise it will be the error that was encountered.
 */
&nbsp;
/**
 * Writes the queue to disk in a JSON file. This file can later be imported
 * using {@link FetchQueue#defrost}
 * @param {String} filename                    Filename passed directly to [fs.writeFile]{@link https://nodejs.org/api/fs.html#fs_fs_writefile_file_data_options_callback}
 * @param {FetchQueue~freezeCallback} callback
 */
FetchQueue.prototype.freeze = <span class="fstat-no" title="function not covered" >function(filename, callback) {</span>
<span class="cstat-no" title="statement not covered" >    var queue = this;</span>
&nbsp;
    // Re-queue in-progress items before freezing...
<span class="cstat-no" title="statement not covered" >    queue.forEach(<span class="fstat-no" title="function not covered" >function(item) {</span></span>
<span class="cstat-no" title="statement not covered" >        if (item.fetched !== true) {</span>
<span class="cstat-no" title="statement not covered" >            item.status = "queued";</span>
        }
    });
&nbsp;
<span class="cstat-no" title="statement not covered" >    fs.writeFile(filename, JSON.stringify(queue, null, 2), <span class="fstat-no" title="function not covered" >function(err) {</span></span>
<span class="cstat-no" title="statement not covered" >        callback(err);</span>
    });
};
&nbsp;
/**
 * Called when {@link FetchQueue#defrost} returns a result
 * @callback FetchQueue~defrostCallback
 * @param {Error} [error] If the operation was successful, this will be `null`. Otherwise it will be the error that was encountered.
 */
&nbsp;
/**
 * Import the queue from a frozen JSON file on disk.
 * @param {String} filename                     Filename passed directly to [fs.readFile]{@link https://nodejs.org/api/fs.html#fs_fs_readfile_file_options_callback}
 * @param {FetchQueue~defrostCallback} callback
 */
FetchQueue.prototype.defrost = <span class="fstat-no" title="function not covered" >function(filename, callback) {</span>
<span class="cstat-no" title="statement not covered" >    var queue = this,</span>
        defrostedQueue = [];
&nbsp;
<span class="cstat-no" title="statement not covered" >    fs.readFile(filename, <span class="fstat-no" title="function not covered" >function(err, fileData) {</span></span>
<span class="cstat-no" title="statement not covered" >        if (err) {</span>
<span class="cstat-no" title="statement not covered" >            return callback(err);</span>
        }
&nbsp;
<span class="cstat-no" title="statement not covered" >        if (!fileData.toString("utf8").length) {</span>
<span class="cstat-no" title="statement not covered" >            return callback(new Error("Failed to defrost queue from zero-length JSON."));</span>
        }
&nbsp;
<span class="cstat-no" title="statement not covered" >        try {</span>
<span class="cstat-no" title="statement not covered" >            defrostedQueue = JSON.parse(fileData.toString("utf8"));</span>
        } catch (error) {
<span class="cstat-no" title="statement not covered" >            return callback(error);</span>
        }
&nbsp;
<span class="cstat-no" title="statement not covered" >        queue._oldestUnfetchedIndex = defrostedQueue.length - 1;</span>
<span class="cstat-no" title="statement not covered" >        queue._scanIndex = {};</span>
&nbsp;
<span class="cstat-no" title="statement not covered" >        for (var i = 0; i &lt; defrostedQueue.length; i++) {</span>
<span class="cstat-no" title="statement not covered" >            var queueItem = defrostedQueue[i];</span>
<span class="cstat-no" title="statement not covered" >            queue.push(queueItem);</span>
&nbsp;
<span class="cstat-no" title="statement not covered" >            if (queueItem.status === "queued") {</span>
<span class="cstat-no" title="statement not covered" >                queue._oldestUnfetchedIndex = Math.min(queue._oldestUnfetchedIndex, i);</span>
            }
&nbsp;
<span class="cstat-no" title="statement not covered" >            queue._scanIndex[queueItem.url] = true;</span>
        }
&nbsp;
<span class="cstat-no" title="statement not covered" >        callback(null, queue);</span>
    });
};
&nbsp;
module.exports = FetchQueue;
&nbsp;
&nbsp;</pre></td></tr>
</table></pre>
</div>
<div class="footer">
    <div class="meta">Generated by <a href="https://github.com/kaizhu256/node-utility2" target="_blank">utility2</a> at Wed Apr 19 2017 01:23:43 GMT+0000 (UTC)</div>
</div>
</body>
</html>
